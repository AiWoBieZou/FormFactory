@using System
@using System.Collections.Generic
@using FormFactory
@using FormFactory.AspMvc
@model PropertyVm

@if (Model.Type.IsGenericType && Model.Type.GetGenericTypeDefinition() == typeof(ICollection<>))
{
    @Html.Partial("FormFactory/Property.ICollection.System.Object", Model)
}
else
{
    <ul>
        @{
            var i = 0;

            foreach (var obj in (IEnumerable<object>) Model.Value)
            {
                <li>
                    @{
                        try
                        {
                            var prop = Html.PropertyVm(obj.GetType(), Model.Name + i, obj);
                            @Html.BestProperty(prop)
                        }
                        catch (Exception ex)
                        {
                            @ex.Message
                        }
                    }
                </li>
            }
        }
    </ul>
}